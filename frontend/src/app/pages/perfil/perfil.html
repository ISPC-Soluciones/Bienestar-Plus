<div class="perfil__container" *ngIf="usuario; else loadingTpl">
  <aside class="perfil__sidebar">
    <div class="usuario__info">
      <img
        src="../../../../public/assets/user-default.png"
        alt="Foto de perfil"
        class="usuario__foto"
      />
      <h2>{{ usuario.nombre }}</h2>
      <p>{{ usuario.email }}</p>
      <button (click)="abrirModal()">Editar perfil</button>
    </div>

    <div class="usuario__detalles">
      <p><strong>GÃ©nero:</strong> {{ usuario.genero || "Sin especificar" }}</p>
      <p><strong>Peso:</strong> {{ usuario.peso || "-" }} kg</p>
      <p><strong>Altura:</strong> {{ usuario.altura || "-" }} cm</p>
      <p>
        <strong>Fecha Nacimiento:</strong> {{ usuario.fecha_nacimiento | date }}
      </p>
    </div>
  </aside>

  <section class="perfil__progreso">
    <h2>Tu progreso diario</h2>

    <div class="progreso__grafico">
      <p *ngIf="rutina?.length">
        {{ habitosCompletados }} de {{ totalHabitos }} hÃ¡bitos completados
      </p>

      <div class="barra__progreso">
        <div
          class="barra__relleno"
          [style.width.%]="porcentajeCompletado"
        ></div>
      </div>
    </div>

    <div class="progreso__detalle">
      <p>SeguÃ­ completando tus hÃ¡bitos para mantener una buena salud ðŸ’ª</p>
    </div>
  </section>

  <section class="perfil__rutina">
    <h2>Mi rutina de hoy</h2>

    <ul *ngIf="rutina?.length; else sinRutina">
      <li *ngFor="let p of rutina">
        <label class="rutina__item">
          <input
            type="checkbox"
            [checked]="p.completado"
            (change)="marcarHabito(p.id, $event)"
          />
          <span [class.completado]="p.completado">{{ p.habito.nombre }}</span>
        </label>
      </li>
    </ul>

    <ng-template #sinRutina>
      <p>No hay hÃ¡bitos cargados para hoy.</p>
    </ng-template>
  </section>
</div>

<ng-template #loadingTpl>
  <p class="loading">Cargando perfil...</p>
</ng-template>
